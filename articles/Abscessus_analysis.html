<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="abscessus">
<title>Abscessus_analysis • abscessus</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Abscessus_analysis">
<meta property="og:description" content="abscessus">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">abscessus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Abscessus_analysis.html">Abscessus_analysis</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Abscessus_analysis</h1>
            
      
      
      <div class="d-none name"><code>Abscessus_analysis.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>This is a study comparing the mortality of transplant patients: those
who were infected with Mycobacterium abscessus vs those who were not
infected. To me, this suggests a retrospective cohort study: Patients
were either exposed or unexposed (to the infection), then either did or
did not experience a binary outcome (death). The resulting 2x2 table
includes a cell containing only 2 patients, so I used Fisher’s exact
test. I hadn’t realised that I would be given survival time as part of
the data. I became concerned that I was throwing information away, so I
then did some standard survival analysis, including a log rank test due
to uncertainty over the PH assumption. This seemed sensible to me.</p>
<p>The paper has been reviewed and the decision is that the statistical
analysis is <em>flawed</em>! There is immortal time bias, because the
exposure (infection) covariate is time-varying and not fixed. Any
revision will be <em>rejected</em> unless a landmark analysis is
implemented. I accept this criticism, though I also would defend my
original analysis using Fisher’s exact test, as I think this is not
biased.</p>
<p>I have never done a landmark analysis (thanks for your survival
analysis book, Dom!). My understanding is that to do a landmark
analysis, I need to choose a cut-off point. At this cut-off point, (1)
all data before the cut-off is discarded, and (2) each patients’
infection status is not allowed to change. That is, any patient that is
uninfected at the cut-off point must be treated as uninfected in the
analysis, regardless of what happens to them.</p>
<p>There are only 9 (nine) patients in the infected group. With this in
mind, I think the most sensible cut-off point would be the day X after
transplant, where X equals the smallest day number that would put all 9
infected patients in the infected group. I would like to hear an opinion
on this. I cannot do this analysis at the moment as I don’t have this
data; I only have death and post-transplant survival/censoring time. I
think I only need “number of days from transplant to infection” for the
9 patients to learn X. I would then discard all patients who died before
day X, and use a new survival variable, “survival/censoring time from
day X”.</p>
<p>I don’t want the paper to be rejected for bad stats(!), so I would
really appreciate an opinion on this before I go ahead.</p>
</div>
<div class="section level2">
<h2 id="analysis-as-submitted">Analysis (as submitted)<a class="anchor" aria-label="anchor" href="#analysis-as-submitted"></a>
</h2>
<div class="section level3">
<h3 id="load-packages-load-anonymised-data-clean-the-data">Load packages, load anonymised data, clean the data<a class="anchor" aria-label="anchor" href="#load-packages-load-anonymised-data-clean-the-data"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DesiQuintans/librarian" class="external-link">librarian</a></span><span class="op">)</span></span>
<span><span class="fu">librarian</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/librarian/man/shelf.html" class="external-link">shelf</a></span><span class="op">(</span><span class="va">survival</span>, <span class="va">survminer</span>,<span class="va">martinlaw</span><span class="op">/</span><span class="va">abscessus</span>, <span class="va">ggplot2</span>, quiet<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   These packages will be installed:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   'survminer', 'ggplot2'</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   It may take some time.</span></span>
<span><span class="co">#&gt; also installing the dependencies 'crayon', 'diffobj', 'rematch2', 'pkgload', 'praise', 'waldo', 'Matrix', 'testthat', 'numDeriv', 'SparseM', 'MatrixModels', 'minqa', 'nloptr', 'RcppEigen', 'carData', 'abind', 'pbkrtest', 'quantreg', 'lme4', 'commonmark', 'Rcpp', 'corrplot', 'car', 'colorspace', 'markdown', 'png', 'jpeg', 'ggrepel', 'ggsci', 'cowplot', 'ggsignif', 'polynom', 'rstatix', 'exactRankTests', 'mvtnorm', 'farver', 'labeling', 'munsell', 'RColorBrewer', 'viridisLite', 'backports', 'generics', 'tidyselect', 'cpp11', 'KMsurv', 'data.table', 'zoo', 'km.ci', 'xtable', 'gridtext', 'ggpubr', 'gridExtra', 'maxstat', 'scales', 'broom', 'dplyr', 'tidyr', 'survMisc', 'ggtext', 'gtable', 'isoband'</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"../data/abscessus_data.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create more informative variable names:</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">infected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span>test<span class="op">=</span><span class="va">dat</span><span class="op">$</span><span class="va">abscessuss_yes_1</span>, yes<span class="op">=</span><span class="st">"Infected"</span>, no<span class="op">=</span><span class="st">"Not infected"</span><span class="op">)</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">alive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span>test<span class="op">=</span><span class="va">dat</span><span class="op">$</span><span class="va">alive_yes_1</span>, yes<span class="op">=</span><span class="st">"Alive"</span>, no<span class="op">=</span><span class="st">"Not alive"</span><span class="op">)</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">lung.dysfun</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span>test<span class="op">=</span><span class="va">dat</span><span class="op">$</span><span class="va">CLAD_yes_1</span>, yes<span class="op">=</span><span class="st">"Yes"</span>, no<span class="op">=</span><span class="st">"No"</span><span class="op">)</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">airway.injury</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span>test<span class="op">=</span><span class="va">dat</span><span class="op">$</span><span class="va">airway_injury_yes_1</span>, yes<span class="op">=</span><span class="st">"Injury"</span>, no<span class="op">=</span><span class="st">"No Injury"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">==</span><span class="st">"survival_post_tx"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"time"</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">status</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">alive_yes_1</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="difference-in-mortality">Difference in mortality<a class="anchor" aria-label="anchor" href="#difference-in-mortality"></a>
</h2>
<div class="section level3">
<h3 id="binary">Binary<a class="anchor" aria-label="anchor" href="#binary"></a>
</h3>
<p>Begin with 2x2 table:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">infected</span>, <span class="va">dat</span><span class="op">$</span><span class="va">alive</span><span class="op">)</span></span>
<span><span class="va">con</span></span>
<span><span class="co">#&gt;               </span></span>
<span><span class="co">#&gt;                Alive Not alive</span></span>
<span><span class="co">#&gt;   Infected         7         2</span></span>
<span><span class="co">#&gt;   Not infected    43        16</span></span></code></pre></div>
<p>Treating survival as binary: No difference between groups when using
Fisher’s Exact Test:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span> </span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Fisher's Exact Test for Count Data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  con</span></span>
<span><span class="co">#&gt; p-value = 1</span></span>
<span><span class="co">#&gt; alternative hypothesis: true odds ratio is not equal to 1</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;   0.2147327 14.0893634</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; odds ratio </span></span>
<span><span class="co">#&gt;   1.297558</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="survival-analysis">Survival analysis<a class="anchor" aria-label="anchor" href="#survival-analysis"></a>
</h3>
<div class="section level4">
<h4 id="plot">Plot<a class="anchor" aria-label="anchor" href="#plot"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">survival</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">infected</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#ggsurvplot(fit, data=dat)</span></span>
<span><span class="va">saved_theme</span> <span class="op">&lt;-</span> <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme</span><span class="op">(</span>axis.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">logrank.plot</span> <span class="op">&lt;-</span> <span class="fu">ggsurvplot</span><span class="op">(</span></span>
<span>   <span class="va">fit</span>,                     <span class="co"># survfit object with calculated statistics.</span></span>
<span>   data <span class="op">=</span> <span class="va">dat</span>,              <span class="co"># data used to fit survival curves. </span></span>
<span>   risk.table <span class="op">=</span> <span class="cn">TRUE</span>,       <span class="co"># show risk table.</span></span>
<span>   pval <span class="op">=</span> <span class="cn">TRUE</span>,             <span class="co"># show p-value of log-rank test.</span></span>
<span>   conf.int <span class="op">=</span> <span class="cn">FALSE</span>,         <span class="co"># show confidence intervals for </span></span>
<span>                            <span class="co"># point estimates of survival curves.</span></span>
<span>   <span class="co">#xlim = c(0,2000),        # present narrower X axis, but not affect</span></span>
<span>                            <span class="co"># survival estimates.</span></span>
<span>   <span class="co">#break.time.by = 500,     # break X axis in time intervals by 500.</span></span>
<span>   ggtheme <span class="op">=</span> <span class="va">saved_theme</span>, <span class="co"># customize plot and risk table with a theme.</span></span>
<span> risk.table.y.text.col <span class="op">=</span> <span class="cn">T</span>, <span class="co"># colour risk table text annotations.</span></span>
<span>  risk.table.y.text <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># show bars instead of names in text annotations</span></span>
<span>                            <span class="co"># in legend of risk table</span></span>
<span> title<span class="op">=</span><span class="st">"Figure 1: Kaplan-Meier survival curves"</span>,</span>
<span><span class="op">)</span></span>
<span><span class="va">logrank.plot</span></span></code></pre></div>
<p><img src="Abscessus_analysis_files/figure-html/plot%20mortality-1.png" width="768"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></span><span class="op">(</span>filename<span class="op">=</span><span class="st">"../figs/logrank_plot.png"</span>, width<span class="op">=</span><span class="fl">8</span>, height<span class="op">=</span><span class="fl">6</span>, units<span class="op">=</span><span class="st">"in"</span>, res<span class="op">=</span><span class="fl">300</span><span class="op">)</span></span>
<span><span class="va">logrank.plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; agg_png </span></span>
<span><span class="co">#&gt;       2</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="log-rank-test">Log-rank test<a class="anchor" aria-label="anchor" href="#log-rank-test"></a>
</h4>
<p>The log-rank test finds no difference in survival times between the
two groups, and is the most appropriate model as it does not assume
proportional hazards.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.diff</span> <span class="op">&lt;-</span> <span class="fu">survdiff</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="va">fit.diff</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; survdiff(formula = formula(fit), data = dat)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                        N Observed Expected (O-E)^2/E (O-E)^2/V</span></span>
<span><span class="co">#&gt; infected=Infected      9        2     2.48    0.0937     0.109</span></span>
<span><span class="co">#&gt; infected=Not infected 59       16    15.52    0.0150     0.109</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Chisq= 0.1  on 1 degrees of freedom, p= 0.7</span></span>
<span><span class="co"># P value:</span></span>
<span><span class="va">fit.diff</span><span class="op">$</span><span class="va">pvalue</span></span>
<span><span class="co">#&gt; [1] 0.7415316</span></span>
<span></span>
<span><span class="va">obs.exp.ratios</span> <span class="op">&lt;-</span> <span class="va">fit.diff</span><span class="op">$</span><span class="va">obs</span><span class="op">/</span><span class="va">fit.diff</span><span class="op">$</span><span class="va">exp</span></span>
<span><span class="co"># Hazard ratio:</span></span>
<span><span class="va">obs.exp.ratios</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">obs.exp.ratios</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 0.7814048</span></span>
<span></span>
<span><span class="co"># Confidence interval (not valid for log-rank, according to Bland and Altman)</span></span>
<span><span class="co"># obs.minus.exp &lt;- fit.diff$obs[1]-fit.diff$exp[1]</span></span>
<span><span class="co"># V &lt;- fit.diff$var[1,1]</span></span>
<span><span class="co"># # V &lt;- obs.minus.exp^2 / fit.diff$chisq # equivalent calculation</span></span>
<span><span class="co"># K &lt;- obs.minus.exp/V</span></span>
<span><span class="co"># log.lower &lt;- K-1.96*sqrt(V)</span></span>
<span><span class="co"># log.upper &lt;- K+1.96*sqrt(V)</span></span>
<span><span class="co"># ci &lt;- exp(c(log.lower, log.upper))</span></span>
<span><span class="co"># ci</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="cox-ph">Cox PH<a class="anchor" aria-label="anchor" href="#cox-ph"></a>
</h4>
<p>Fitting a Cox proportional hazards model also does not show an
effect, though from the plot above, the assumption of proportional
hazards appears to not hold.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cox.no.covar</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">infected</span>, data <span class="op">=</span> <span class="va">dat</span><span class="op">)</span></span>
<span><span class="co"># Test PH assumption:</span></span>
<span><span class="fu">cox.zph</span><span class="op">(</span><span class="va">cox.no.covar</span><span class="op">)</span></span>
<span><span class="co">#&gt;          chisq df   p</span></span>
<span><span class="co">#&gt; infected 0.147  1 0.7</span></span>
<span><span class="co">#&gt; GLOBAL   0.147  1 0.7</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">cox.zph</span><span class="op">(</span><span class="va">cox.no.covar</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Abscessus_analysis_files/figure-html/coxPH-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cox.no.covar</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; coxph(formula = Surv(time, status) ~ infected, data = dat)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   n= 68, number of events= 18 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                        coef exp(coef) se(coef)     z Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; infectedNot infected 0.2468    1.2799   0.7502 0.329    0.742</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                      exp(coef) exp(-coef) lower .95 upper .95</span></span>
<span><span class="co">#&gt; infectedNot infected      1.28     0.7813    0.2942     5.569</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Concordance= 0.514  (se = 0.038 )</span></span>
<span><span class="co">#&gt; Likelihood ratio test= 0.12  on 1 df,   p=0.7</span></span>
<span><span class="co">#&gt; Wald test            = 0.11  on 1 df,   p=0.7</span></span>
<span><span class="co">#&gt; Score (logrank) test = 0.11  on 1 df,   p=0.7</span></span>
<span><span class="va">recip.coef</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cox.no.covar</span><span class="op">)</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cox.no.covar</span><span class="op">)</span><span class="op">$</span><span class="va">coef</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">recip.coef</span><span class="op">-</span><span class="fl">1.96</span><span class="op">*</span><span class="va">se</span>, <span class="va">recip.coef</span><span class="op">+</span><span class="fl">1.96</span><span class="op">*</span><span class="va">se</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ci</span></span>
<span><span class="co">#&gt; [1] 0.179566 3.399374</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="descriptive-statistics">Descriptive statistics<a class="anchor" aria-label="anchor" href="#descriptive-statistics"></a>
</h3>
<p>Using Wilcoxon rank-sum test for continuous variables and Fisher’s
Exact Test for categorical variables (due to the small group size)</p>
<div class="section level4">
<h4 id="survivalcensoring-time-age-at-transplant">Survival/censoring time, age at transplant<a class="anchor" aria-label="anchor" href="#survivalcensoring-time-age-at-transplant"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Follow up:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;     1.0   508.2   741.0   725.0  1033.5  1225.0</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">age_at_tx</span> <span class="op">~</span> <span class="va">infected</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Wilcoxon rank sum test with continuity correction</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  age_at_tx by infected</span></span>
<span><span class="co">#&gt; W = 277, p-value = 0.8421</span></span>
<span><span class="co">#&gt; alternative hypothesis: true location shift is not equal to 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">age_at_tx</span>, <span class="va">dat</span><span class="op">$</span><span class="va">infected</span>, <span class="va">summary</span><span class="op">)</span></span>
<span><span class="co">#&gt; $Infected</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;   46.00   50.00   54.00   54.56   60.00   64.00 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Not infected`</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;   20.00   46.00   56.00   52.69   60.00   68.00</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="bmi-pre-transplant">BMI pre-transplant<a class="anchor" aria-label="anchor" href="#bmi-pre-transplant"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html" class="external-link">wilcox.test</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">bmi_pre_tx</span> <span class="op">~</span> <span class="va">infected</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Wilcoxon rank sum test with continuity correction</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  bmi_pre_tx by infected</span></span>
<span><span class="co">#&gt; W = 262.5, p-value = 0.9639</span></span>
<span><span class="co">#&gt; alternative hypothesis: true location shift is not equal to 0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">bmi_pre_tx</span>, <span class="va">dat</span><span class="op">$</span><span class="va">infected</span>, <span class="va">summary</span><span class="op">)</span></span>
<span><span class="co">#&gt; $Infected</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;   20.00   22.30   23.50   24.38   24.40   35.20 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`Not infected`</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;   16.70   21.35   23.70   23.96   26.95   32.00</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="sex">Sex<a class="anchor" aria-label="anchor" href="#sex"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">infected</span>, <span class="va">dat</span><span class="op">$</span><span class="va">gender_male_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Fisher's Exact Test for Count Data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  dat$infected and dat$gender_male_1</span></span>
<span><span class="co">#&gt; p-value = 1</span></span>
<span><span class="co">#&gt; alternative hypothesis: true odds ratio is not equal to 1</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  0.1329911 4.7844602</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; odds ratio </span></span>
<span><span class="co">#&gt;  0.9060624</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">infected</span>, <span class="va">dat</span><span class="op">$</span><span class="va">gender_male_1</span><span class="op">)</span>, margin<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;               </span></span>
<span><span class="co">#&gt;                   f    m</span></span>
<span><span class="co">#&gt;   Infected     0.33 0.67</span></span>
<span><span class="co">#&gt;   Not infected 0.36 0.64</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="donor-type">Donor type<a class="anchor" aria-label="anchor" href="#donor-type"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">infected</span>, <span class="va">dat</span><span class="op">$</span><span class="va">donortype</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Fisher's Exact Test for Count Data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  dat$infected and dat$donortype</span></span>
<span><span class="co">#&gt; p-value = 0.6805</span></span>
<span><span class="co">#&gt; alternative hypothesis: true odds ratio is not equal to 1</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  0.1146778 4.3746267</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; odds ratio </span></span>
<span><span class="co">#&gt;  0.6269587</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">infected</span>, <span class="va">dat</span><span class="op">$</span><span class="va">donortype</span><span class="op">)</span>, margin<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;               </span></span>
<span><span class="co">#&gt;                 DBD  DCD</span></span>
<span><span class="co">#&gt;   Infected     0.67 0.33</span></span>
<span><span class="co">#&gt;   Not infected 0.76 0.24</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="organ-infected">Organ infected<a class="anchor" aria-label="anchor" href="#organ-infected"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">infected</span>, <span class="va">dat</span><span class="op">$</span><span class="va">organ_1_single</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Fisher's Exact Test for Count Data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  dat$infected and dat$organ_1_single</span></span>
<span><span class="co">#&gt; p-value = 0.6742</span></span>
<span><span class="co">#&gt; alternative hypothesis: true odds ratio is not equal to 1</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  0.007758465 3.179263171</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; odds ratio </span></span>
<span><span class="co">#&gt;  0.3710222</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">infected</span>, <span class="va">dat</span><span class="op">$</span><span class="va">organ_1_single</span><span class="op">)</span>, margin<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;               </span></span>
<span><span class="co">#&gt;                   1    2</span></span>
<span><span class="co">#&gt;   Infected     0.11 0.89</span></span>
<span><span class="co">#&gt;   Not infected 0.25 0.75</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="gord">GORD<a class="anchor" aria-label="anchor" href="#gord"></a>
</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">infected</span>, <span class="va">dat</span><span class="op">$</span><span class="va">gord_yes_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Fisher's Exact Test for Count Data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  dat$infected and dat$gord_yes_1</span></span>
<span><span class="co">#&gt; p-value = 0.7266</span></span>
<span><span class="co">#&gt; alternative hypothesis: true odds ratio is not equal to 1</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  0.2792571 9.9053215</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; odds ratio </span></span>
<span><span class="co">#&gt;    1.46251</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">infected</span>, <span class="va">dat</span><span class="op">$</span><span class="va">gord_yes_1</span><span class="op">)</span>, margin<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;               </span></span>
<span><span class="co">#&gt;                   0    1</span></span>
<span><span class="co">#&gt;   Infected     0.67 0.33</span></span>
<span><span class="co">#&gt;   Not infected 0.58 0.42</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="clad">CLAD<a class="anchor" aria-label="anchor" href="#clad"></a>
</h4>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">infected</span>, <span class="va">dat</span><span class="op">$</span><span class="va">CLAD_yes_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Fisher's Exact Test for Count Data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  dat$infected and dat$CLAD_yes_1</span></span>
<span><span class="co">#&gt; p-value = 0.6541</span></span>
<span><span class="co">#&gt; alternative hypothesis: true odds ratio is not equal to 1</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  0.1116612 8.0831793</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; odds ratio </span></span>
<span><span class="co">#&gt;  0.7181202</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">infected</span>, <span class="va">dat</span><span class="op">$</span><span class="va">CLAD_yes_1</span><span class="op">)</span>, margin<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;               </span></span>
<span><span class="co">#&gt;                   0    1</span></span>
<span><span class="co">#&gt;   Infected     0.78 0.22</span></span>
<span><span class="co">#&gt;   Not infected 0.83 0.17</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="airway-injury">Airway injury<a class="anchor" aria-label="anchor" href="#airway-injury"></a>
</h4>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">infected</span>, <span class="va">dat</span><span class="op">$</span><span class="va">airway.injury</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Fisher's Exact Test for Count Data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  dat$infected and dat$airway.injury</span></span>
<span><span class="co">#&gt; p-value = 0.1898</span></span>
<span><span class="co">#&gt; alternative hypothesis: true odds ratio is not equal to 1</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;   0.3739068 15.9388804</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; odds ratio </span></span>
<span><span class="co">#&gt;   2.725754</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">infected</span>, <span class="va">dat</span><span class="op">$</span><span class="va">airway.injury</span><span class="op">)</span>, margin<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;               </span></span>
<span><span class="co">#&gt;                Injury No Injury</span></span>
<span><span class="co">#&gt;   Infected       0.33      0.67</span></span>
<span><span class="co">#&gt;   Not infected   0.15      0.85</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="immunosuppressed">Immunosuppressed<a class="anchor" aria-label="anchor" href="#immunosuppressed"></a>
</h4>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">infected</span>, <span class="va">dat</span><span class="op">$</span><span class="va">immunosuppressed_pre_yes_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Fisher's Exact Test for Count Data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  dat$infected and dat$immunosuppressed_pre_yes_1</span></span>
<span><span class="co">#&gt; p-value = 0.1898</span></span>
<span><span class="co">#&gt; alternative hypothesis: true odds ratio is not equal to 1</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  0.06273966 2.67446291</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; odds ratio </span></span>
<span><span class="co">#&gt;   0.366871</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">infected</span>, <span class="va">dat</span><span class="op">$</span><span class="va">immunosuppressed_pre_yes_1</span><span class="op">)</span>, margin<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;               </span></span>
<span><span class="co">#&gt;                   0    1</span></span>
<span><span class="co">#&gt;   Infected     0.67 0.33</span></span>
<span><span class="co">#&gt;   Not infected 0.85 0.15</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="pgd">PGD<a class="anchor" aria-label="anchor" href="#pgd"></a>
</h4>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">infected</span>, <span class="va">dat</span><span class="op">$</span><span class="va">PGD_yes_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Fisher's Exact Test for Count Data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  dat$infected and dat$PGD_yes_1</span></span>
<span><span class="co">#&gt; p-value = 0.3361</span></span>
<span><span class="co">#&gt; alternative hypothesis: true odds ratio is not equal to 1</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  0.3804105       Inf</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; odds ratio </span></span>
<span><span class="co">#&gt;        Inf</span></span>
<span><span class="co"># Note infinite OR due to zero cell.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">infected</span>, <span class="va">dat</span><span class="op">$</span><span class="va">PGD_yes_1</span><span class="op">)</span>, margin<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;               </span></span>
<span><span class="co">#&gt;                   0    1</span></span>
<span><span class="co">#&gt;   Infected     1.00 0.00</span></span>
<span><span class="co">#&gt;   Not infected 0.81 0.19</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html" class="external-link">fisher.test</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">infected</span>, <span class="va">dat</span><span class="op">$</span><span class="va">CLAD_yes_1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Fisher's Exact Test for Count Data</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  dat$infected and dat$CLAD_yes_1</span></span>
<span><span class="co">#&gt; p-value = 0.6541</span></span>
<span><span class="co">#&gt; alternative hypothesis: true odds ratio is not equal to 1</span></span>
<span><span class="co">#&gt; 95 percent confidence interval:</span></span>
<span><span class="co">#&gt;  0.1116612 8.0831793</span></span>
<span><span class="co">#&gt; sample estimates:</span></span>
<span><span class="co">#&gt; odds ratio </span></span>
<span><span class="co">#&gt;  0.7181202</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/proportions.html" class="external-link">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">infected</span>, <span class="va">dat</span><span class="op">$</span><span class="va">CLAD_yes_1</span><span class="op">)</span>, margin<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;               </span></span>
<span><span class="co">#&gt;                   0    1</span></span>
<span><span class="co">#&gt;   Infected     0.78 0.22</span></span>
<span><span class="co">#&gt;   Not infected 0.83 0.17</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="reviewer-comments-on-revision-1">Reviewer comments on revision 1<a class="anchor" aria-label="anchor" href="#reviewer-comments-on-revision-1"></a>
</h2>
<p><strong>Please add more information regarding the survival
analysis:</strong></p>
<p><strong>which covariates were used</strong></p>
<p>No covariates were used, given the small sample size and small number
of events.</p>
<p><strong>how model was built</strong></p>
<p>Model was fitted in R, using the survival pacakge [cite, cite]. The
code used is available on github [cite].</p>
<p><strong>comment on how robust it is (given that there were only 9
patients in one group).</strong></p>
<p>Landmark analysis conducted with cut off at 114 days (to minimise
imbalance of group sizes): agrees with time-dependent covariate analysis
(no evidence of difference in groups).</p>
<p>Comment on proportional hazards assumption. In KM plot, survival
curves cross, which indicates a violation of PH, though the data are
sparse (with just 9 participants in one group).</p>
<p>Examine Schoenfeld residuals?</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by First Last.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
